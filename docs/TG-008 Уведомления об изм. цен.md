# Уведомление об изменении цен на выбранную КВ<br>
## Задача<br>
#### 1. Дать пользователю возможность задавать отслеживание изменения цен по КВ. Количество КВ должно быть ограничено, для каждого пользователя индивидуально (первоначальное ограничение прописывается в настроечной таблице, дальнейшее ограничение у каждого пользователя прописывается индивидуально).<br>
## Работы<br>
#### 1. [x] Переименовать текущую таблицу Users в LogMsg<br>
#### 2. [x] Изменить в pgsql.go:CollectData запись с таблицы Users на LogMsg<br>
#### 3. Для обеспечения безопасности:<br>
##### 3.1 [x] Создать таблицу надстроек уровней доступа LevelsSecureAdd со следующими полями:<br>
    - idLvlSecAdd - уникальный идентификатор, автоинкремент, PK, sql_type:"SERIAL PRIMARY KEY"<br>
    - nameLvlSecAdd - наименование надстройки, sql_type:"TEXT"
    - activeLvlSecAdd - активна/неактивна надстройка, sql_type:"BOOLEAN DEFAULT FALSE"
    - lvlSecId - уровень доступа пользователя, sql_type:"INTEGER REFERENCES LevelsSecure (idLvlSec)"
#### 3.2 [x] Создать таблицу уровней доступа LevelsSecure со следующими полями:<br>
    - idLvlSec - уровень доступа пользователя, уникальный идентификатор, автоинкремент, PK, sql_type:"SERIAL PRIMARY KEY"
    - nameLvlSec - наименование уровня доступа пользователя, sql_type:"TEXT"
#### 3.3 [x] Создать таблицу разграничений привилегий пользователей Groups со следующими полями:<br>
    - idGrp - уникальный идентификатор, автоинкремент, PK, sql_type:"SERIAL PRIMARY KEY"
    - nameGrp - наименование группы пользователей, sql_type:"TEXT"
    - lvlSecId - уровень доступа группа пользователя, sql_type:"INTEGER REFERENCES LevelsSecure (idLvlSec)"
#### 3.4 [x] Создать таблицу уникальных пользователей Users со следующими полями:<br>
    - idUsr - уникальный идентификатор, автоинкремент, PK, sql_type:"SERIAL PRIMARY KEY"
    - tsUsr - дата и время добавления пользователя, sql_type:"TIMESTAMP DEFAULT CURRENT_TIMESTAMP"
    - nameUsr - символическое имя пользователя в Telegram, sql_type:"TEXT"
    - chatIdUsr - идентификатор чата пользователя с ботом, sql_type:"INTEGER"
    - groupId - группа привилегий пользователя, sql_type:"INTEGER REFERENCES Groups (idGrp)"
### 4. Для введения ограничений действий пользователей:<br>
#### 4.1 [x] Создать таблицу справочник лимитов для пользователей LimitsDict со следующими полями:<br>
    - idLmtDct - уникальный идентификатор, автоинкремент, PK, sql_type:"SERIAL PRIMARY KEY"
    - nameLmtDct - наименование лимита пользователя, sql_type:"TEXT"
    - stdValLmt - значение лимита по умолчанию, sql_type:"INTEGER DEFAULT 0"
#### 4.2 [ ] Создать таблицу лимитов для пользователей Limits со следующими полями:<br>
    - idLmt - уникальный идентификатор, автоинкремент, PK, sql_type:"SERIAL PRIMARY KEY"
    - valAvailLmt - значение доступного лимита пользователя, sql_type:"INTEGER NULL"
    - valUsedLmt - значение использованного лимита пользователя, sql_type:"INTEGER NULL"
    - activeLmt - активен/неактивен лимит, sql_type:"BOOLEAN NOT NULL DEFAULT FALSE"
    - tsLmtOn - дата и время активации лимита, sql_type:"TIMESTAMP NULL"
    - tsLmtOff - дата и время деактивации лимита, sql_type:"TIMESTAMP NULL"
    - userId - идентификатор пользователя из Users, sql_type:"INTEGER REFERENCES Users (idUsr)"
### 5. Для отслеживания КВ:<br>
#### 5.1 [x] Создать таблицу типов отслеживания КВ TypeTrackingCrypto со следующими полями:<br>
    - idTypTrkCrp - уникальный идентификатор, автоинкремент, PK, sql_type:"SERIAL PRIMARY KEY"
    - nameTypeTrkCrp - обозначение типа отслеживания, sql_type:"TEXT NOT NULL"
    - modeTypTrkCrp - режим типа отслеживания (значение, процент и т.д.), sql_type:"TEXT NOT NULL"
    Где первоначальные типы будут: Выше (Raise) и Ниже (Lose), числовые и процентные
#### 5.2 [x] Создать таблицу отслеживаемых КВ пользователем TrackingCrypto со следующими полями:<br>
    - idTrkCrp - уникальный идентификатор, автоинкремент, PK, sql_type:"SERIAL PRIMARY KEY"
    - valTrkCrp - максимальная граница для отслеживания, вычисляется из текущего значения цены КВ и значения выданного пользователем, sql_type:"NUMERIC(15,9)"    
    - typTrkCrpId - тип отслеживания КВ, sql_type:"INTEGER REFERENCES TypeTrackingCrypto (idTypTrkCrp)"
    - dctCrpId - идентификатор КВ в словаре DictCrypto, sql_type:"INTEGER REFERENCES DictCrypto (CryptoId)
    - userId - идентификатор пользователя из Users, sql_type:"INTEGER REFERENCES Users (idUsr)"
### 6. [x] Создать новый пакет, с функцией как точка входа, способная работать как go сабрутина<br>
#### [x] Назначить канал обмена между "Ретривером" (мастер) и "Уведомлениями" (клиент). Структура канала:<br>
    - RetrieverDone - работа ретривера окончена, type:bool<br>
#### [x] Сабрутина "Уведомления" после получения команды, сравнивает последние значения, полученные из словаря КВ с граничными значениями из таблицы отслеживания КВ.<br>
#### Если какая-то валюта вышла за границы отслеживания, то отправляется сообщение соответствующему пользователю в чат. Для этого нужно сделать сабрутину с каналом между "Уведомлениями" и "Ботом".<br>
#### [ ] Добавить алгоритм добавления пользователя
#### [ ] Заполнить настройки и сделать выборку ищ БД по пользователям